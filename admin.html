<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–º–∏–Ω–∫–∞ - –ì–∞—Ä–∞–Ω—Ç-–ñ–∏–ª—å–µ</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
--primary: #1E3A8A;
--primary-dark: #172554;
--secondary: #BFDBFE;
--accent: #D4AF37;
--text: #000000;
--bg: #F5F7FA;
--border: #E2E8F0;
--text-secondary: #64748B;
--shadow-sm: 0 2px 8px rgba(30, 58, 138, 0.08);
--shadow-md: 0 6px 16px rgba(30, 58, 138, 0.12);
--shadow-lg: 0 12px 28px rgba(30, 58, 138, 0.18);
--transition: cubic-bezier(0.22, 0.61, 0.36, 1);
}
body {
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
background: var(--bg);
color: var(--text);
padding: 20px;
margin: 0;
}
.container {
max-width: 1400px;
margin: 0 auto;
}
.header {
background: linear-gradient(135deg, var(--primary), var(--primary-dark));
color: white;
padding: 30px;
border-radius: 15px;
margin-bottom: 30px;
box-shadow: var(--shadow-lg);
}
.header h1 {
font-size: 32px;
margin-bottom: 10px;
}
.header p {
opacity: 0.9;
font-size: 16px;
}
.tabs {
display: flex;
gap: 10px;
margin-bottom: 30px;
flex-wrap: wrap;
background: white;
padding: 10px;
border-radius: 12px;
box-shadow: var(--shadow-sm);
}
.tab-btn {
padding: 12px 24px;
background: white;
border: none;
border-radius: 10px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s;
box-shadow: var(--shadow-sm);
}
.tab-btn:hover {
transform: translateY(-2px);
box-shadow: var(--shadow-md);
}
.tab-btn.active {
background: linear-gradient(135deg, var(--primary), var(--primary-dark));
color: white;
}
.tab-content {
display: none;
}
.tab-content.active {
display: block;
}
.card {
background: white;
border-radius: 15px;
padding: 25px;
margin-bottom: 25px;
box-shadow: var(--shadow-md);
}
.card h2 {
margin-bottom: 20px;
color: var(--primary);
font-size: 24px;
display: flex;
align-items: center;
gap: 10px;
}
.card h2 svg {
width: 24px;
height: 24px;
}
.form-group {
margin-bottom: 20px;
}
.form-group label {
display: block;
margin-bottom: 8px;
font-weight: 600;
color: var(--text-secondary);
}
.form-control {
width: 100%;
padding: 12px 15px;
border: 2px solid var(--border);
border-radius: 10px;
font-size: 15px;
transition: border-color 0.3s;
}
.form-control:focus {
outline: none;
border-color: var(--primary);
}
.form-control[type="file"] {
padding: 3px;
}
textarea.form-control {
min-height: 120px;
resize: vertical;
}
.btn {
padding: 12px 24px;
border: none;
border-radius: 10px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s;
display: inline-flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, var(--primary), var(--primary-dark));
color: white;
box-shadow: var(--shadow-md);
}
.btn-primary {
background: linear-gradient(135deg, var(--primary), var(--primary-dark));
color: white;
}
.btn-primary:hover {
transform: translateY(-2px);
box-shadow: var(--shadow-lg);
}
.btn-primary:disabled {
opacity: 0.6;
cursor: not-allowed;
transform: none;
}
.btn-danger {
background: linear-gradient(135deg, #ef4444, #dc2626);
color: white;
}
.btn-danger:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
}
.btn-success {
background: linear-gradient(135deg, #10b981, #059669);
color: white;
}
.btn-success:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
}
.btn-secondary {
background: linear-gradient(135deg, #64748b, #475569);
color: white;
}
.properties-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
gap: 20px;
margin-top: 20px;
}
.property-card {
background: white;
border-radius: 12px;
overflow: hidden;
box-shadow: var(--shadow-sm);
transition: transform 0.3s;
}
.property-card:hover {
transform: translateY(-5px);
box-shadow: var(--shadow-md);
}
.property-image {
height: 180px;
background-size: cover;
background-position: center;
}
.property-info {
padding: 15px;
}
.property-title {
font-weight: 700;
font-size: 16px;
margin-bottom: 8px;
color: var(--primary);
}
.property-price {
color: #10b981;
font-weight: 600;
margin-bottom: 5px;
}
.property-address {
color: var(--text-secondary);
font-size: 13px;
margin-bottom: 10px;
}
.property-district {
display: inline-block;
background: #f0f4f8;
color: var(--primary);
padding: 4px 10px;
border-radius: 20px;
font-size: 12px;
font-weight: 600;
margin-bottom: 8px;
}
.property-tags {
display: flex;
gap: 6px;
margin: 8px 0;
}
.property-tag {
font-size: 11px;
font-weight: 600;
padding: 3px 8px;
border-radius: 12px;
}
.property-tag.hot {
background: #ffedd5;
color: #c2410c;
}
.property-tag.hit {
background: #dbeafe;
color: #1e40af;
}
.property-actions {
display: flex;
gap: 8px;
margin-top: 10px;
}
.badge {
display: inline-block;
padding: 4px 10px;
border-radius: 20px;
font-size: 12px;
font-weight: 600;
}
.badge-primary {
background: #bfdbfe;
color: var(--primary);
}
.badge-success {
background: #dcfce7;
color: #059669;
}
.badge-danger {
background: #fee2e2;
color: #dc2626;
}
.orders-list, .requests-list {
display: flex;
flex-direction: column;
gap: 15px;
}
.order-card, .request-card {
background: white;
border-radius: 12px;
padding: 20px;
box-shadow: var(--shadow-sm);
border-left: 4px solid var(--primary);
}
.order-header, .request-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
padding-bottom: 15px;
border-bottom: 1px solid var(--border);
}
.order-number, .request-number {
font-weight: 700;
font-size: 18px;
color: var(--primary);
}
.order-status, .request-status {
padding: 6px 14px;
border-radius: 20px;
font-weight: 600;
font-size: 14px;
}
.status-new {
background: #ffedd5;
color: #c2410c;
}
.status-process {
background: #dbeafe;
color: #1e40af;
}
.status-done {
background: #dcfce7;
color: #059669;
}
.order-body, .request-body {
margin-bottom: 15px;
}
.order-item, .request-item {
padding: 10px;
background: #f8fafc;
border-radius: 8px;
margin-bottom: 8px;
}
.order-footer, .request-footer {
display: flex;
justify-content: space-between;
align-items: center;
padding-top: 15px;
border-top: 1px solid var(--border);
}
.banner-list {
display: flex;
flex-direction: column;
gap: 15px;
}
.banner-item {
display: flex;
align-items: center;
gap: 15px;
padding: 15px;
background: white;
border-radius: 12px;
box-shadow: var(--shadow-sm);
position: relative;
}
.banner-image {
width: 150px;
height: 100px;
background-size: cover;
background-position: center;
border-radius: 8px;
}
.banner-info {
flex: 1;
}
.banner-title {
font-weight: 600;
margin-bottom: 5px;
}
.banner-link {
color: var(--text-secondary);
font-size: 13px;
word-break: break-all;
}
.banner-page {
font-size: 12px;
font-weight: 600;
padding: 4px 10px;
border-radius: 20px;
margin-bottom: 5px;
}
.banner-page.home {
background: #bfdbfe;
color: var(--primary);
}
.banner-page.thailand {
background: #fbbf24;
color: #92400e;
}
.banner-page.jk {
background: #86efac;
color: #065f46;
}
.banner-order {
width: 60px;
text-align: center;
font-weight: 600;
color: var(--primary);
}
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
margin-top: 20px;
}
.stat-card {
background: white;
border-radius: 15px;
padding: 25px;
text-align: center;
box-shadow: var(--shadow-md);
}
.stat-number {
font-size: 42px;
font-weight: 700;
color: var(--primary);
margin: 10px 0;
}
.stat-label {
color: var(--text-secondary);
font-size: 16px;
}
.empty-state {
text-align: center;
color: var(--text-secondary);
padding: 40px 20px;
font-style: italic;
}
.empty-state svg {
width: 64px;
height: 64px;
margin-bottom: 20px;
stroke: var(--text-secondary);
stroke-width: 2;
}
.loading {
text-align: center;
padding: 40px;
color: var(--text-secondary);
}
.loading-spinner {
width: 40px;
height: 40px;
border: 4px solid var(--border);
border-top-color: var(--primary);
border-radius: 50%;
animation: spin 0.8s linear infinite;
margin: 0 auto 16px;
}
@keyframes spin {
to { transform: rotate(360deg); }
}
.upload-progress-container {
background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
border-radius: 12px;
padding: 20px;
margin: 20px 0;
border: 2px solid var(--primary);
box-shadow: var(--shadow-sm);
display: none;
}
.upload-progress-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
}
.upload-progress-title {
font-weight: 700;
color: var(--primary);
font-size: 16px;
display: flex;
align-items: center;
gap: 8px;
}
.upload-progress-title svg {
width: 20px;
height: 20px;
}
.upload-progress-percentage {
font-weight: 700;
color: var(--primary);
font-size: 18px;
}
.progress-bar-outer {
width: 100%;
background: #e2e8f0;
border-radius: 20px;
height: 28px;
overflow: hidden;
margin-bottom: 12px;
box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
}
.progress-bar-inner {
height: 100%;
background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
border-radius: 20px;
width: 0%;
transition: width 0.1s ease;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: 600;
font-size: 14px;
}
.upload-status {
font-size: 14px;
color: var(--text-secondary);
margin-top: 10px;
display: flex;
align-items: center;
gap: 8px;
}
.upload-status svg {
width: 18px;
height: 18px;
}
.upload-status.uploading {
color: var(--primary);
}
.upload-status.success {
color: #10b981;
}
.upload-status.error {
color: #ef4444;
}
.upload-status.processing {
color: #f59e0b;
}
.form-group-shifr {
background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
border-left: 4px solid var(--primary);
padding: 20px;
border-radius: 10px;
margin-bottom: 25px;
box-shadow: var(--shadow-sm);
}
.form-group-shifr small {
color: var(--text-secondary);
font-size: 13px;
display: block;
margin-top: 8px;
line-height: 1.5;
}
.form-group-shifr code {
background: rgba(30, 58, 138, 0.1);
padding: 2px 6px;
border-radius: 4px;
font-family: 'Courier New', monospace;
font-weight: 600;
}
.search-box {
margin-bottom: 20px;
position: relative;
}
.search-input {
width: 100%;
padding: 12px 40px 12px 16px;
border: 2px solid var(--border);
border-radius: 12px;
font-size: 15px;
transition: border-color 0.3s;
}
.search-input:focus {
outline: none;
border-color: var(--primary);
}
.search-box::before {
content: 'üîç';
position: absolute;
right: 16px;
top: 50%;
transform: translateY(-50%);
color: var(--text-secondary);
font-size: 18px;
}
.action-buttons {
display: flex;
gap: 10px;
}
.action-buttons .btn {
flex: 1;
}
.modal {
display: none;
position: fixed;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(0, 0, 0, 0.5);
z-index: 9999;
justify-content: center;
align-items: center;
}
.modal.active {
display: flex;
}
.modal-content {
background: white;
border-radius: 15px;
padding: 30px;
max-width: 500px;
width: 90%;
box-shadow: var(--shadow-lg);
}
.modal-title {
font-size: 20px;
font-weight: 700;
margin-bottom: 16px;
color: var(--text);
}
.modal-text {
color: var(--text-secondary);
margin-bottom: 24px;
line-height: 1.6;
}
.modal-buttons {
display: flex;
gap: 12px;
}
.modal-buttons .btn {
flex: 1;
}
.categories-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 15px;
margin-bottom: 25px;
}
.category-btn {
background: white;
border: 2px solid var(--primary);
border-radius: 12px;
padding: 15px;
text-align: center;
font-weight: 600;
font-size: 14px;
color: var(--primary);
cursor: pointer;
transition: all 0.3s;
box-shadow: var(--shadow-sm);
}
.category-btn:hover {
background: var(--primary);
color: white;
transform: translateY(-2px);
box-shadow: var(--shadow-md);
}
.category-btn.active {
background: var(--primary);
color: white;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
.users-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
gap: 20px;
margin-top: 20px;
}
.user-card {
background: white;
border-radius: 12px;
overflow: hidden;
box-shadow: var(--shadow-sm);
transition: transform 0.3s;
border-left: 4px solid var(--primary);
}
.user-card:hover {
transform: translateY(-5px);
box-shadow: var(--shadow-md);
}
.user-info {
padding: 20px;
}
.user-username {
font-weight: 700;
font-size: 18px;
margin-bottom: 5px;
color: var(--primary);
}
.user-full-name {
color: var(--text-secondary);
font-size: 14px;
margin-bottom: 10px;
}
.user-meta {
margin-bottom: 15px;
padding-bottom: 15px;
border-bottom: 1px solid var(--border);
}
.user-meta p {
color: var(--text-secondary);
font-size: 13px;
margin-bottom: 3px;
}
.user-actions {
display: flex;
gap: 8px;
margin-top: 10px;
}
@media (max-width: 768px) {
.properties-grid, .users-grid {
grid-template-columns: 1fr;
}
.tabs {
flex-direction: column;
}
.tab-btn {
width: 100%;
}
.header {
padding: 20px;
}
.header h1 {
font-size: 24px;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>üè† –ê–¥–º–∏–Ω–∫–∞ - –ì–∞—Ä–∞–Ω—Ç-–ñ–∏–ª—å–µ</h1>
<p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏, –∑–∞–∫–∞–∑–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏</p>
</div>
<div class="tabs">
<button class="tab-btn active" onclick="showTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</button>
<button class="tab-btn" onclick="showTab('properties')">üèòÔ∏è –û–±—ä—è–≤–ª–µ–Ω–∏—è</button>
<button class="tab-btn" onclick="showTab('add-property')">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
<button class="tab-btn" onclick="showTab('banners')">üñºÔ∏è –ë–∞–Ω–Ω–µ—Ä—ã</button>
<button class="tab-btn" onclick="showTab('orders')">üì¶ –ó–∞–∫–∞–∑—ã</button>
<button class="tab-btn" onclick="showTab('requests')">üìù –ó–∞—è–≤–∫–∏</button>
<button class="tab-btn" onclick="showTab('users')">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
</div>
<!-- –î–ê–®–ë–û–†–î -->
<div id="dashboard" class="tab-content active">
<div class="stats-grid">
<div class="stat-card">
<div>–í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>
<div class="stat-number" id="total-properties">0</div>
<div class="stat-label">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
</div>
<div class="stat-card">
<div>–ó–∞–∫–∞–∑–æ–≤ —Å–µ–≥–æ–¥–Ω—è</div>
<div class="stat-number" id="today-orders">0</div>
<div class="stat-label">–Ω–æ–≤—ã—Ö</div>
</div>
<div class="stat-card">
<div>–ù–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</div>
<div class="stat-number" id="new-requests">0</div>
<div class="stat-label">–≤ –æ–∂–∏–¥–∞–Ω–∏–∏</div>
</div>
<div class="stat-card">
<div>–ë–∞–Ω–Ω–µ—Ä–æ–≤</div>
<div class="stat-number" id="total-banners">0</div>
<div class="stat-label">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
</div>
<div class="stat-card">
<div>–†–∞–π–æ–Ω–æ–≤</div>
<div class="stat-number" id="total-districts">0</div>
<div class="stat-label">–≤ —Ñ–∏–ª—å—Ç—Ä–µ</div>
</div>
<div class="stat-card">
<div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
<div class="stat-number" id="total-users">0</div>
<div class="stat-label">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
</div>
</div>
<div class="card">
<h2>
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"></path>
</svg>
–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
</h2>
<div id="recent-orders"></div>
</div>
<div class="card">
<h2>
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"></path>
</svg>
–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏
</h2>
<div id="recent-requests"></div>
</div>
</div>
<!-- –û–ë–™–Ø–í–õ–ï–ù–ò–Ø -->
<div id="properties" class="tab-content">
<div class="card">
<h2>üìã –í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
<div class="categories-grid">
<button class="category-btn active" onclick="filterPropertiesByCategory('all')">–í—Å–µ</button>
<button class="category-btn" onclick="filterPropertiesByCategory('primary')">–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏</button>
<button class="category-btn" onclick="filterPropertiesByCategory('secondary')">–í—Ç–æ—Ä–∏—á–∫–∞</button>
<button class="category-btn" onclick="filterPropertiesByCategory('thailand')">–¢–∞–∏–ª–∞–Ω–¥</button>
</div>
<div class="search-box">
<input type="text" class="search-input" id="properties-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É, –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–¥—Ä–µ—Å—É..." oninput="searchProperties()">
</div>
<div id="properties-list" class="properties-grid"></div>
</div>
</div>
<!-- –î–û–ë–ê–í–ò–¢–¨ –û–ë–™–Ø–í–õ–ï–ù–ò–ï -->
<div id="add-property" class="tab-content">
<div class="card">
<h2>‚ûï –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h2>
<form id="property-form" enctype="multipart/form-data">
<div class="form-group-shifr">
<label>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–®–∏—Ñ—Ä) *</label>
<input type="text" class="form-control" name="property_number" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: NOVIKOV344, IVANOV123" required>
<small>üí° <strong>–í–∞–∂–Ω–æ:</strong> –≠—Ç–æ—Ç —à–∏—Ñ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ –∞–¥–º–∏–Ω–∫–µ. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä: <code>NOVIKOV344</code>, <code>IVANOV123</code>, <code>SMITH567</code>). –ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º, —Å–∏—Å—Ç–µ–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –Ω–æ–º–µ—Ä.</small>
</div>
<div class="form-group">
<label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ *</label>
<input type="text" class="form-control" name="title" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2-–∫–æ–º–Ω. –∫–≤–∞—Ä—Ç–∏—Ä–∞ —É –º–µ—Ç—Ä–æ">
</div>
<div class="form-group">
<label>–¶–µ–Ω–∞ *</label>
<input type="text" class="form-control" name="price" required placeholder="–æ—Ç 12 300 000 ‚ÇΩ">
</div>
<div class="form-group">
<label>–†—ã–Ω–æ–∫ *</label>
<select class="form-control" name="market" required>
<option value="primary">–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏</option>
<option value="secondary">–í—Ç–æ—Ä–∏—á–∫–∞</option>
<option value="thailand">–¢–∞–∏–ª–∞–Ω–¥</option>
</select>
</div>
<div class="form-group">
<label>–¢–∏–ø *</label>
<select class="form-control" name="type" required>
<option value="apartment">–ö–≤–∞—Ä—Ç–∏—Ä–∞</option>
<option value="house">–î–æ–º</option>
</select>
</div>
<div class="form-group">
<label>–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å (–¥–ª—è –Ω–æ–≤–æ—Å—Ç—Ä–æ–µ–∫)</label>
<input type="text" class="form-control" name="jk" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–æ—Ä–∏–∑–æ–Ω—Ç">
</div>
<div class="form-group">
<label>–†–∞–π–æ–Ω *</label>
<input type="text" class="form-control" name="district" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π, –ö–∏—Ä–æ–≤—Å–∫–∏–π">
<small style="color: var(--text-secondary); font-size: 12px;">–≠—Ç–æ—Ç —Ä–∞–π–æ–Ω –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ñ–∏–ª—å—Ç—Ä —Ä–∞–π–æ–Ω–æ–≤</small>
</div>
<div class="form-group">
<label>–ê–¥—Ä–µ—Å *</label>
<input type="text" class="form-control" name="address" required placeholder="—É–ª. –õ–µ–Ω–∏–Ω–∞, 42, –ú–æ—Å–∫–≤–∞">
</div>
<div class="form-group">
<label>–û–ø–∏—Å–∞–Ω–∏–µ *</label>
<textarea class="form-control" name="description" required placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞..."></textarea>
</div>
<div class="form-group">
<label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–æ 50 —Ñ–∞–π–ª–æ–≤) *</label>
<input type="file" class="form-control" id="images-input" name="images" multiple accept="image/*" required onchange="validateFiles()">
</div>
<div id="upload-progress-container" class="upload-progress-container">
<div class="upload-progress-header">
<div class="upload-progress-title">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 5v14M5 12h14"></path>
</svg>
–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
</div>
<div class="upload-progress-percentage" id="progress-percentage">0%</div>
</div>
<div class="progress-bar-outer">
<div class="progress-bar-inner" id="progress-bar-inner" style="width: 0%">0%</div>
</div>
<div class="upload-status uploading" id="upload-status">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<circle cx="12" cy="12" r="10"></circle>
</svg>
–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ...
</div>
</div>
<div class="form-group">
<label>
<input type="checkbox" name="is_hot" value="on">
–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤ "–ì–æ—Ä—è—á–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö" –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
</label>
</div>
<div class="form-group">
<label>
<input type="checkbox" name="is_hit" value="on">
–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤ "–•–∏—Ç–∞—Ö –ø—Ä–æ–¥–∞–∂" –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
</label>
</div>
<button type="submit" id="submit-btn" class="btn btn-primary" disabled>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 5v14M5 12h14"></path>
</svg>
–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
</button>
</form>
</div>
</div>
<!-- –ë–ê–ù–ù–ï–†–´ -->
<div id="banners" class="tab-content">
<div class="card">
<h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–∞–Ω–Ω–µ—Ä</h2>
<form id="banner-form" enctype="multipart/form-data">
<div class="form-group">
<label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞ *</label>
<input type="file" class="form-control" name="image" accept="image/*" required>
</div>
<div class="form-group">
<label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
<input type="text" class="form-control" name="title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–æ–ª—å–∫–æ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π!">
</div>
<div class="form-group">
<label>–°—Ç—Ä–∞–Ω–∏—Ü–∞ *</label>
<select class="form-control" name="page" id="banner-page" required onchange="toggleBannerFields()">
<option value="home">–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</option>
<option value="thailand">–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¢–∞–∏–ª–∞–Ω–¥–∞</option>
</select>
</div>
<div class="form-group" id="target-property-group" style="display: none;">
<label>–û–±—ä—è–≤–ª–µ–Ω–∏–µ (–¥–ª—è –±–∞–Ω–Ω–µ—Ä–æ–≤ –¢–∞–∏–ª–∞–Ω–¥–∞) *</label>
<select class="form-control" name="target_property_id" id="target-property-select">
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ...</option>
</select>
</div>
<div class="form-group" id="banner-order-group">
<label>–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä *</label>
<input type="number" class="form-control" name="order" min="1" max="10" value="1" required>
</div>
<div class="form-group" id="banner-link-group">
<label>–°—Å—ã–ª–∫–∞ (–¥–ª—è –±–∞–Ω–Ω–µ—Ä–æ–≤ –≥–ª–∞–≤–Ω–æ–π)</label>
<input type="url" class="form-control" name="link" placeholder="https://example.com">
</div>
<button type="submit" class="btn btn-primary">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 5v14M5 12h14"></path>
</svg>
–î–æ–±–∞–≤–∏—Ç—å –±–∞–Ω–Ω–µ—Ä
</button>
</form>
</div>
<div class="card">
<h2>üñºÔ∏è –°–ø–∏—Å–æ–∫ –±–∞–Ω–Ω–µ—Ä–æ–≤</h2>
<div id="banners-list" class="banner-list"></div>
</div>
</div>
<!-- –ó–ê–ö–ê–ó–´ -->
<div id="orders" class="tab-content">
<div class="card">
<h2>üì¶ –í—Å–µ –∑–∞–∫–∞–∑—ã</h2>
<div class="search-box">
<input type="text" class="search-input" id="orders-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É, –∏–º–µ–Ω–∏ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É..." oninput="searchOrders()">
</div>
<div id="orders-list" class="orders-list"></div>
</div>
</div>
<!-- –ó–ê–Ø–í–ö–ò -->
<div id="requests" class="tab-content">
<div class="card">
<h2>üìù –í—Å–µ –∑–∞—è–≤–∫–∏</h2>
<div class="search-box">
<input type="text" class="search-input" id="requests-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É, –∏–º–µ–Ω–∏, —Ç–µ–ª–µ—Ñ–æ–Ω—É –∏–ª–∏ –∞–¥—Ä–µ—Å—É..." oninput="searchRequests()">
</div>
<div id="requests-list" class="requests-list"></div>
</div>
</div>
<!-- –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò -->
<div id="users" class="tab-content">
<div class="card">
<h2>üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
<button class="btn btn-primary" onclick="showAddUserModal()" style="margin-bottom: 20px;">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M12 5v14M5 12h14"></path>
</svg>
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
</button>
<div class="search-box">
<input type="text" class="search-input" id="users-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∏–Ω—É –∏–ª–∏ –∏–º–µ–Ω–∏..." oninput="searchUsers()">
</div>
<div id="users-list" class="users-grid"></div>
</div>
</div>
</div>
<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –£–î–ê–õ–ï–ù–ò–Ø -->
<div id="delete-modal" class="modal">
<div class="modal-content">
<h3 class="modal-title">‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h3>
<p class="modal-text" id="delete-modal-text">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
<div class="modal-buttons">
<button class="btn btn-danger" onclick="confirmDelete()">–£–¥–∞–ª–∏—Ç—å</button>
<button class="btn btn-primary" onclick="closeDeleteModal()">–û—Ç–º–µ–Ω–∞</button>
</div>
</div>
</div>
<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø -->
<div id="add-user-modal" class="modal">
<div class="modal-content" style="max-width: 500px;">
<h3 class="modal-title">‚ûï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
<form id="add-user-form">
<div class="form-group">
<label>–õ–æ–≥–∏–Ω *</label>
<input type="text" class="form-control" name="username" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ivanov">
<small style="color: var(--text-secondary); font-size: 12px;">–¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤</small>
</div>
<div class="form-group">
<label>–ü–∞—Ä–æ–ª—å *</label>
<input type="password" class="form-control" name="password" required placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
<small style="color: var(--text-secondary); font-size: 12px;">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å - –æ–Ω –Ω–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è</small>
</div>
<div class="form-group">
<label>–§–ò–û (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
<input type="text" class="form-control" name="full_name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
</div>
<div class="modal-buttons">
<button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
<button type="button" class="btn btn-secondary" onclick="closeAddUserModal()">–û—Ç–º–µ–Ω–∞</button>
</div>
</form>
</div>
</div>
<script>
const API_BASE = 'http://localhost:5000/api/admin';
let deleteType = null;
let deleteId = null;
let currentCategory = 'all';
let selectedFiles = [];

function showTab(tabId) {
document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
document.getElementById(tabId).classList.add('active');
event.target.classList.add('active');
if (tabId === 'dashboard') loadDashboard();
if (tabId === 'properties') {
currentCategory = 'all';
document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
document.querySelector('.category-btn:first-child').classList.add('active');
loadProperties();
document.getElementById('properties-search').value = '';
}
if (tabId === 'banners') {
loadBanners();
loadThailandPropertiesForSelect();
}
if (tabId === 'orders') {
loadOrders();
document.getElementById('orders-search').value = '';
}
if (tabId === 'requests') {
loadRequests();
document.getElementById('requests-search').value = '';
}
if (tabId === 'users') {
loadUsers();
document.getElementById('users-search').value = '';
}
}

function filterPropertiesByCategory(category) {
currentCategory = category;
document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
event.target.classList.add('active');
loadProperties();
}

function validateFiles() {
const filesInput = document.getElementById('images-input');
const submitBtn = document.getElementById('submit-btn');
const progressContainer = document.getElementById('upload-progress-container');
selectedFiles = Array.from(filesInput.files);
if (selectedFiles.length === 0) {
progressContainer.style.display = 'none';
submitBtn.disabled = true;
return;
}
if (selectedFiles.length > 50) {
alert(`–ú–∞–∫—Å–∏–º—É–º 50 —Ñ–æ—Ç–æ! –í—ã –≤—ã–±—Ä–∞–ª–∏ ${selectedFiles.length}`);
filesInput.value = '';
progressContainer.style.display = 'none';
submitBtn.disabled = true;
return;
}
const maxSize = 30 * 1024 * 1024;
const tooLargeFiles = selectedFiles.filter(file => file.size > maxSize);
if (tooLargeFiles.length > 0) {
alert(`–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ! –ú–∞–∫—Å–∏–º—É–º 5 –ú–ë –Ω–∞ —Ñ–∞–π–ª.
–°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ: ${tooLargeFiles.map(f => f.name).join(', ')}`);
filesInput.value = '';
progressContainer.style.display = 'none';
submitBtn.disabled = true;
return;
}
submitBtn.disabled = false;
}

async function loadDashboard() {
try {
const [propertiesRes, ordersRes, requestsRes, bannersRes, usersRes] = await Promise.all([
fetch(`${API_BASE}/properties`),
fetch(`${API_BASE}/orders`),
fetch(`${API_BASE}/sell-requests`),
fetch(`${API_BASE}/banners`),
fetch(`${API_BASE}/users`)
]);
const properties = await propertiesRes.json();
const orders = await ordersRes.json();
const requests = await requestsRes.json();
const banners = await bannersRes.json();
const users = await usersRes.json();
document.getElementById('total-properties').textContent = properties.filter(p => p.is_active).length;
document.getElementById('total-banners').textContent = banners.filter(b => b.is_active).length;
document.getElementById('total-users').textContent = users.filter(u => u.is_active).length;
const today = new Date().toISOString().split('T')[0];
const todayOrders = orders.filter(o => o.created_at.startsWith(today));
document.getElementById('today-orders').textContent = todayOrders.length;
const newRequests = requests.filter(r => r.status === '–ù–æ–≤–∞—è');
document.getElementById('new-requests').textContent = newRequests.length;
const districts = [...new Set(properties
.filter(p => p.is_active)
.map(p => p.district || p.address.split(',')[0].trim())
.filter(Boolean)
)];
document.getElementById('total-districts').textContent = districts.length;
const recentOrdersHtml = orders.slice(0, 5).map(order => `
<div class="order-card">
<div class="order-header">
<span class="order-number">#${order.order_number}</span>
<span class="order-status ${getStatusClass(order.status)}">${order.status}</span>
</div>
<div class="order-body">
${order.items.map(item => `
<div class="order-item">
<strong>${item.title}</strong><br>
${item.address} ‚Äî ${item.price}
</div>
`).join('')}
</div>
<div class="order-footer">
<span>üìû ${order.customer_phone || '‚Äî'}</span>
<span>üìÖ ${new Date(order.created_at).toLocaleDateString('ru-RU')}</span>
<button class="btn btn-success" onclick="updateOrderStatus(${order.id}, '–í —Ä–∞–±–æ—Ç–µ')">–í —Ä–∞–±–æ—Ç—É</button>
</div>
</div>
`).join('');
document.getElementById('recent-orders').innerHTML = recentOrdersHtml || '<div class="empty-state">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</div>';
const recentRequestsHtml = requests.slice(0, 5).map(req => `
<div class="request-card">
<div class="request-header">
<span class="request-number">#${req.request_number}</span>
<span class="request-status ${getStatusClass(req.status)}">${req.status}</span>
</div>
<div class="request-body">
<div class="request-item">
<strong>–¢–∏–ø:</strong> ${req.type === 'buy' ? '–ü–æ–∫—É–ø–∫–∞' : '–ü—Ä–æ–¥–∞–∂–∞'}<br>
<strong>–ò–º—è:</strong> ${req.name}<br>
<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${req.phone}<br>
<strong>–ê–¥—Ä–µ—Å:</strong> ${req.address}<br>
<strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${req.description}
</div>
</div>
<div class="request-footer">
<span>üìÖ ${new Date(req.created_at).toLocaleDateString('ru-RU')}</span>
<button class="btn btn-success" onclick="updateRequestStatus(${req.id}, '–í —Ä–∞–±–æ—Ç—É')">–í —Ä–∞–±–æ—Ç—É</button>
</div>
</div>
`).join('');
document.getElementById('recent-requests').innerHTML = recentRequestsHtml || '<div class="empty-state">–ù–µ—Ç –∑–∞—è–≤–æ–∫</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞:', error);
alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
}
}

async function loadProperties() {
try {
const response = await fetch(`${API_BASE}/properties`);
let properties = await response.json();
if (currentCategory !== 'all') {
properties = properties.filter(p => p.market === currentCategory);
}
const activeProperties = properties.filter(p => p.is_active);
const html = activeProperties.map(prop => `
<div class="property-card" id="property-${prop.id}">
<div class="property-image" style="background-image: url('${prop.images[0]}')"></div>
<div class="property-info">
${prop.district ? `<div class="property-district">${prop.district}</div>` : ''}
<div class="property-title">${prop.property_number} - ${prop.title}</div>
<div class="property-price">${prop.price}</div>
<div class="property-address">${prop.address}</div>
<div class="property-tags">
${prop.is_hot ? `<span class="property-tag hot">üî• –ì–æ—Ä—è—á–µ–µ</span>` : ''}
${prop.is_hit ? `<span class="property-tag hit">‚≠ê –•–∏—Ç</span>` : ''}
</div>
<div style="margin: 10px 0;">
<span class="badge badge-primary">${prop.market}</span>
<span class="badge badge-primary">${prop.type}</span>
${prop.jk ? `<span class="badge badge-primary">${prop.jk}</span>` : ''}
<span class="badge badge-success">–ê–∫—Ç–∏–≤–Ω–æ</span>
</div>
<div class="property-actions">
<button class="btn btn-primary" onclick="editProperty(${prop.id})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('property', ${prop.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('properties-list').innerHTML = html || '<div class="empty-state">–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
}
}

async function loadBanners() {
try {
const response = await fetch(`${API_BASE}/banners`);
const banners = await response.json();
const activeBanners = banners.filter(b => b.is_active);
const html = activeBanners.map(banner => `
<div class="banner-item" id="banner-${banner.id}">
<div class="banner-order">#${banner.order}</div>
<div class="banner-image" style="background-image: url('${banner.image}')"></div>
<div class="banner-info">
<div class="banner-page ${banner.page}">${getPageName(banner.page)}</div>
<div class="banner-title">${banner.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</div>
${banner.page === 'home' ?
`<div class="banner-link">${banner.link || '‚Äî'}</div>` :
banner.page === 'thailand' ?
`<div class="banner-link">–û–±—ä–µ–∫—Ç: #${banner.target_property_id || '‚Äî'}</div>` :
`<div class="banner-link">–ñ–ö: ${banner.target_jk || '‚Äî'}, ${banner.market || '‚Äî'}, ${banner.type || '‚Äî'}</div>`
}
</div>
<div style="display: flex; gap: 10px;">
<button class="btn btn-primary" onclick="editBanner(${banner.id})">‚úèÔ∏è</button>
<button class="btn btn-danger" onclick="prepareDelete('banner', ${banner.id})">üóëÔ∏è</button>
</div>
</div>
`).join('');
document.getElementById('banners-list').innerHTML = html || '<div class="empty-state">–ù–µ—Ç –±–∞–Ω–Ω–µ—Ä–æ–≤</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–Ω–Ω–µ—Ä–æ–≤:', error);
alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–Ω–Ω–µ—Ä–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
}
}

function getPageName(page) {
const names = { 'home': '–ì–ª–∞–≤–Ω–∞—è', 'thailand': '–¢–∞–∏–ª–∞–Ω–¥', 'jk': '–ñ–ö' };
return names[page] || page;
}

async function loadThailandPropertiesForSelect() {
try {
const response = await fetch('http://localhost:5000/api/thailand');
const properties = await response.json();
const select = document.getElementById('target-property-select');
select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ...</option>' +
properties.map(prop => `<option value="${prop.id}">${prop.property_number} - ${prop.title} - ${prop.price}</option>`).join('');
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –¢–∞–∏–ª–∞–Ω–¥–∞:', error);
}
}

async function loadOrders() {
try {
const response = await fetch(`${API_BASE}/orders`);
const orders = await response.json();
const html = orders.map(order => `
<div class="order-card" id="order-${order.id}">
<div class="order-header">
<span class="order-number">#${order.order_number}</span>
<span class="order-status ${getStatusClass(order.status)}">${order.status}</span>
</div>
<div class="order-body">
${order.items.map(item => `
<div class="order-item">
<strong>${item.title}</strong><br>
${item.address} ‚Äî ${item.price}
</div>
`).join('')}
<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border);">
<strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${order.customer_name || '‚Äî'}<br>
<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${order.customer_phone || '‚Äî'}<br>
<strong>Telegram ID:</strong> ${order.customer_tg_id || '‚Äî'}
</div>
</div>
<div class="order-footer">
<span>üìÖ ${new Date(order.created_at).toLocaleString('ru-RU')}</span>
<div class="action-buttons">
<button class="btn btn-success" onclick="updateOrderStatus(${order.id}, '–í —Ä–∞–±–æ—Ç—É')">–í —Ä–∞–±–æ—Ç—É</button>
<button class="btn btn-primary" onclick="updateOrderStatus(${order.id}, '–ó–∞–≤–µ—Ä—à–µ–Ω')">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('order', ${order.id})">–£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('orders-list').innerHTML = html || '<div class="empty-state">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
}
}

async function loadRequests() {
try {
const response = await fetch(`${API_BASE}/sell-requests`);
const requests = await response.json();
const html = requests.map(req => `
<div class="request-card" id="request-${req.id}">
<div class="request-header">
<span class="request-number">#${req.request_number}</span>
<span class="request-status ${getStatusClass(req.status)}">${req.status}</span>
</div>
<div class="request-body">
<div class="request-item">
<strong>–¢–∏–ø:</strong> ${req.type === 'buy' ? '–ü–æ–∫—É–ø–∫–∞' : '–ü—Ä–æ–¥–∞–∂–∞'}<br>
<strong>–ò–º—è:</strong> ${req.name}<br>
<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${req.phone}<br>
<strong>–ê–¥—Ä–µ—Å:</strong> ${req.address}<br>
<strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${req.description}
</div>
${req.photos && req.photos.length > 0 ? `
<div style="margin-top: 10px;">
<strong>–§–æ—Ç–æ:</strong>
<div style="display: flex; gap: 5px; margin-top: 5px;">
${req.photos.map(photo => `<img src="${photo}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;">`).join('')}
</div>
</div>
` : ''}
</div>
<div class="request-footer">
<span>üìÖ ${new Date(req.created_at).toLocaleString('ru-RU')}</span>
<div class="action-buttons">
<button class="btn btn-success" onclick="updateRequestStatus(${req.id}, '–í —Ä–∞–±–æ—Ç—É')">–í —Ä–∞–±–æ—Ç—É</button>
<button class="btn btn-primary" onclick="updateRequestStatus(${req.id}, '–ó–∞–≤–µ—Ä—à–µ–Ω–∞')">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('request', ${req.id})">–£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('requests-list').innerHTML = html || '<div class="empty-state">–ù–µ—Ç –∑–∞—è–≤–æ–∫</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:', error);
}
}

// === –§–£–ù–ö–¶–ò–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô ===
async function loadUsers() {
try {
const response = await fetch(`${API_BASE}/users`);
const users = await response.json();
const html = users.map(user => `
<div class="user-card" style="border-left: 4px solid ${user.is_active ? 'var(--primary)' : '#ef4444'};">
<div class="user-info">
<div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
<div>
<h3 class="user-username">${user.username}</h3>
<p class="user-full-name">${user.full_name || '‚Äî'}</p>
</div>
<span class="badge ${user.is_active ? 'badge-success' : 'badge-danger'}" style="font-size: 12px;">
${user.is_active ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}
</span>
</div>
<div class="user-meta">
<p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 3px;">
<strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date(user.created_at).toLocaleDateString('ru-RU', {day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'})}
</p>
${user.last_login ? `
<p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 3px;">
<strong>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥:</strong> ${new Date(user.last_login).toLocaleDateString('ru-RU', {day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'})}
</p>
` : ''}
</div>
<div class="user-actions">
<button class="btn btn-primary" onclick="editUser(${user.id}, '${user.username}', '${user.full_name || ''}', ${user.is_active})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('user', ${user.id})">üóëÔ∏è ${user.is_active ? '–î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' : '–£–¥–∞–ª–∏—Ç—å'}</button>
</div>
</div>
</div>
`).join('');
document.getElementById('users-list').innerHTML = html || '<div class="empty-state">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
}
}

function searchUsers() {
const query = document.getElementById('users-search').value.trim().toLowerCase();
if (!query) {
loadUsers();
return;
}
fetch(`${API_BASE}/users`)
.then(res => res.json())
.then(users => {
const filtered = users.filter(u =>
u.username.toLowerCase().includes(query) ||
(u.full_name && u.full_name.toLowerCase().includes(query))
);
const html = filtered.map(user => `
<div class="user-card" style="border-left: 4px solid ${user.is_active ? 'var(--primary)' : '#ef4444'};">
<div class="user-info">
<div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
<div>
<h3 class="user-username">${user.username}</h3>
<p class="user-full-name">${user.full_name || '‚Äî'}</p>
</div>
<span class="badge ${user.is_active ? 'badge-success' : 'badge-danger'}" style="font-size: 12px;">
${user.is_active ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}
</span>
</div>
<div class="user-meta">
<p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 3px;">
<strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date(user.created_at).toLocaleDateString('ru-RU', {day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'})}
</p>
${user.last_login ? `
<p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 3px;">
<strong>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥:</strong> ${new Date(user.last_login).toLocaleDateString('ru-RU', {day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'})}
</p>
` : ''}
</div>
<div class="user-actions">
<button class="btn btn-primary" onclick="editUser(${user.id}, '${user.username}', '${user.full_name || ''}', ${user.is_active})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('user', ${user.id})">üóëÔ∏è ${user.is_active ? '–î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' : '–£–¥–∞–ª–∏—Ç—å'}</button>
</div>
</div>
</div>
`).join('');
document.getElementById('users-list').innerHTML = html || '<div class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
})
.catch(error => console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error));
}

function showAddUserModal() {
document.getElementById('add-user-modal').classList.add('active');
document.getElementById('add-user-form').reset();
}

function closeAddUserModal() {
document.getElementById('add-user-modal').classList.remove('active');
}

document.getElementById('add-user-form').addEventListener('submit', async (e) => {
e.preventDefault();
const formData = new FormData(e.target);
const data = {
username: formData.get('username'),
password: formData.get('password'),
full_name: formData.get('full_name')
};
try {
const response = await fetch(`${API_BASE}/users`, {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify(data)
});
const result = await response.json();
if (result.success) {
alert(result.message);
closeAddUserModal();
loadUsers();
loadDashboard();
} else {
alert('‚ùå ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
}
});

function editUser(id, username, fullName, isActive) {
const newUsername = prompt('–ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–Ω:', username);
if (newUsername === null) return;
const newFullName = prompt('–ò–∑–º–µ–Ω–∏—Ç—å –§–ò–û:', fullName);
if (newFullName === null) return;
const newIsActive = confirm('–ê–∫—Ç–∏–≤–µ–Ω?');
fetch(`${API_BASE}/users/${id}`, {
method: 'PUT',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({
username: newUsername,
full_name: newFullName,
is_active: newIsActive
})
})
.then(res => res.json())
.then(result => {
if (result.success) {
alert(result.message);
loadUsers();
} else {
alert('‚ùå ' + result.error);
}
})
.catch(error => {
console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
});
}

async function deleteUser(id) {
try {
const response = await fetch(`${API_BASE}/users/${id}`, { method: 'DELETE' });
const result = await response.json();
if (result.success) {
alert(result.message);
loadUsers();
loadDashboard();
} else {
alert('‚ùå ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
}
}

// === –§–£–ù–ö–¶–ò–ò –ü–û–ò–°–ö–ê ===
function searchProperties() {
const query = document.getElementById('properties-search').value.trim().toLowerCase();
if (!query) {
loadProperties();
return;
}
fetch(`${API_BASE}/properties?search=${encodeURIComponent(query)}`)
.then(res => res.json())
.then(properties => {
if (currentCategory !== 'all') {
properties = properties.filter(p => p.market === currentCategory);
}
const activeProperties = properties.filter(p => p.is_active);
const html = activeProperties.map(prop => `
<div class="property-card" id="property-${prop.id}">
<div class="property-image" style="background-image: url('${prop.images[0]}')"></div>
<div class="property-info">
${prop.district ? `<div class="property-district">${prop.district}</div>` : ''}
<div class="property-title">${prop.property_number} - ${prop.title}</div>
<div class="property-price">${prop.price}</div>
<div class="property-address">${prop.address}</div>
<div class="property-tags">
${prop.is_hot ? `<span class="property-tag hot">üî• –ì–æ—Ä—è—á–µ–µ</span>` : ''}
${prop.is_hit ? `<span class="property-tag hit">‚≠ê –•–∏—Ç</span>` : ''}
</div>
<div style="margin: 10px 0;">
<span class="badge badge-primary">${prop.market}</span>
<span class="badge badge-primary">${prop.type}</span>
${prop.jk ? `<span class="badge badge-primary">${prop.jk}</span>` : ''}
<span class="badge badge-success">–ê–∫—Ç–∏–≤–Ω–æ</span>
</div>
<div class="property-actions">
<button class="btn btn-primary" onclick="editProperty(${prop.id})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('property', ${prop.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('properties-list').innerHTML = html || '<div class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
})
.catch(error => console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error));
}

function searchOrders() {
const query = document.getElementById('orders-search').value.trim().toLowerCase();
if (!query) {
loadOrders();
return;
}
fetch(`${API_BASE}/orders?search=${encodeURIComponent(query)}`)
.then(res => res.json())
.then(orders => {
const html = orders.map(order => `
<div class="order-card" id="order-${order.id}">
<div class="order-header">
<span class="order-number">#${order.order_number}</span>
<span class="order-status ${getStatusClass(order.status)}">${order.status}</span>
</div>
<div class="order-body">
${order.items.map(item => `
<div class="order-item">
<strong>${item.title}</strong><br>
${item.address} ‚Äî ${item.price}
</div>
`).join('')}
<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border);">
<strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${order.customer_name || '‚Äî'}<br>
<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${order.customer_phone || '‚Äî'}<br>
<strong>Telegram ID:</strong> ${order.customer_tg_id || '‚Äî'}
</div>
</div>
<div class="order-footer">
<span>üìÖ ${new Date(order.created_at).toLocaleString('ru-RU')}</span>
<div class="action-buttons">
<button class="btn btn-success" onclick="updateOrderStatus(${order.id}, '–í —Ä–∞–±–æ—Ç—É')">–í —Ä–∞–±–æ—Ç—É</button>
<button class="btn btn-primary" onclick="updateOrderStatus(${order.id}, '–ó–∞–≤–µ—Ä—à–µ–Ω')">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('order', ${order.id})">–£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('orders-list').innerHTML = html || '<div class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
})
.catch(error => console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error));
}

function searchRequests() {
const query = document.getElementById('requests-search').value.trim().toLowerCase();
if (!query) {
loadRequests();
return;
}
fetch(`${API_BASE}/sell-requests?search=${encodeURIComponent(query)}`)
.then(res => res.json())
.then(requests => {
const html = requests.map(req => `
<div class="request-card" id="request-${req.id}">
<div class="request-header">
<span class="request-number">#${req.request_number}</span>
<span class="request-status ${getStatusClass(req.status)}">${req.status}</span>
</div>
<div class="request-body">
<div class="request-item">
<strong>–¢–∏–ø:</strong> ${req.type === 'buy' ? '–ü–æ–∫—É–ø–∫–∞' : '–ü—Ä–æ–¥–∞–∂–∞'}<br>
<strong>–ò–º—è:</strong> ${req.name}<br>
<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${req.phone}<br>
<strong>–ê–¥—Ä–µ—Å:</strong> ${req.address}<br>
<strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${req.description}
</div>
${req.photos && req.photos.length > 0 ? `
<div style="margin-top: 10px;">
<strong>–§–æ—Ç–æ:</strong>
<div style="display: flex; gap: 5px; margin-top: 5px;">
${req.photos.map(photo => `<img src="${photo}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;">`).join('')}
</div>
</div>
` : ''}
</div>
<div class="request-footer">
<span>üìÖ ${new Date(req.created_at).toLocaleString('ru-RU')}</span>
<div class="action-buttons">
<button class="btn btn-success" onclick="updateRequestStatus(${req.id}, '–í —Ä–∞–±–æ—Ç—É')">–í —Ä–∞–±–æ—Ç—É</button>
<button class="btn btn-primary" onclick="updateRequestStatus(${req.id}, '–ó–∞–≤–µ—Ä—à–µ–Ω–∞')">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
<button class="btn btn-danger" onclick="prepareDelete('request', ${req.id})">–£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>
`).join('');
document.getElementById('requests-list').innerHTML = html || '<div class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
})
.catch(error => console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error));
}

// === –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø ===
async function deleteProperty(id) {
try {
const response = await fetch(`${API_BASE}/properties/${id}`, { method: 'DELETE' });
const result = await response.json();
if (result.success) {
alert('‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ');
document.getElementById(`property-${id}`).remove();
loadDashboard();
if (document.getElementById('properties').classList.contains('active')) loadProperties();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
}
}

async function deleteBanner(id) {
try {
const response = await fetch(`${API_BASE}/banners/${id}`, { method: 'DELETE' });
const result = await response.json();
if (result.success) {
alert('‚úÖ –ë–∞–Ω–Ω–µ—Ä —É–¥–∞–ª–µ–Ω');
document.getElementById(`banner-${id}`).remove();
loadDashboard();
if (document.getElementById('banners').classList.contains('active')) loadBanners();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
}
}

async function deleteOrder(id) {
try {
const response = await fetch(`${API_BASE}/orders/${id}`, { method: 'DELETE' });
const result = await response.json();
if (result.success) {
alert('‚úÖ –ó–∞–∫–∞–∑ —É–¥–∞–ª–µ–Ω');
document.getElementById(`order-${id}`).remove();
loadDashboard();
if (document.getElementById('orders').classList.contains('active')) loadOrders();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
}
}

async function deleteRequest(id) {
try {
const response = await fetch(`${API_BASE}/sell-requests/${id}`, { method: 'DELETE' });
const result = await response.json();
if (result.success) {
alert('‚úÖ –ó–∞—è–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞');
document.getElementById(`request-${id}`).remove();
loadDashboard();
if (document.getElementById('requests').classList.contains('active')) loadRequests();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
}
}

async function updateRequestStatus(id, status) {
try {
const response = await fetch(`${API_BASE}/sell-requests/${id}/status`, {
method: 'PUT',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({ status: status })
});
const result = await response.json();
if (result.success) {
alert('‚úÖ –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω');
loadRequests();
loadDashboard();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
}
}

async function updateOrderStatus(id, status) {
try {
const response = await fetch(`${API_BASE}/orders/${id}/status`, {
method: 'PUT',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({ status: status })
});
const result = await response.json();
if (result.success) {
alert('‚úÖ –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω');
loadOrders();
loadDashboard();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
}
}

// === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –£–î–ê–õ–ï–ù–ò–Ø ===
function prepareDelete(type, id) {
deleteType = type;
deleteId = id;
let text = '';
switch(type) {
case 'property':
text = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ? –û–Ω–æ –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–æ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞.';
break;
case 'banner':
text = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –±–∞–Ω–Ω–µ—Ä? –û–Ω –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç —Å —Å–∞–π—Ç–∞.';
break;
case 'order':
text = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∑–∞–∫–∞–∑? –û–Ω –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç –∏–∑ —Å–ø–∏—Å–∫–∞.';
break;
case 'request':
text = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞—è–≤–∫—É? –û–Ω–∞ –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞.';
break;
case 'user':
text = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –û–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É.';
break;
}
document.getElementById('delete-modal-text').textContent = text;
document.getElementById('delete-modal').classList.add('active');
}

function confirmDelete() {
switch(deleteType) {
case 'property':
deleteProperty(deleteId);
break;
case 'banner':
deleteBanner(deleteId);
break;
case 'order':
deleteOrder(deleteId);
break;
case 'request':
deleteRequest(deleteId);
break;
case 'user':
deleteUser(deleteId);
break;
}
closeDeleteModal();
}

function closeDeleteModal() {
document.getElementById('delete-modal').classList.remove('active');
deleteType = null;
deleteId = null;
}

// === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
function getStatusClass(status) {
if (status.includes('–ù–æ–≤–∞—è') || status.includes('–ù–æ–≤—ã–π')) return 'status-new';
if (status.includes('–≤ —Ä–∞–±–æ—Ç–µ') || status.includes('–æ–±—Ä–∞–±')) return 'status-process';
if (status.includes('–∑–∞–≤–µ—Ä—à') || status.includes('–≥–æ—Ç–æ–≤') || status.includes('–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω')) return 'status-done';
return 'status-new';
}

function toggleBannerFields() {
const page = document.getElementById('banner-page').value;
const targetPropertyGroup = document.getElementById('target-property-group');
const orderGroup = document.getElementById('banner-order-group');
const linkGroup = document.getElementById('banner-link-group');
targetPropertyGroup.style.display = 'none';
orderGroup.style.display = 'block';
linkGroup.style.display = 'block';
if (page === 'thailand') {
targetPropertyGroup.style.display = 'block';
linkGroup.style.display = 'none';
loadThailandPropertiesForSelect();
}
}

// === –û–ë–†–ê–ë–û–¢–ß–ò–ö –§–û–†–ú–´ –û–ë–™–Ø–í–õ–ï–ù–ò–Ø ===
document.getElementById('property-form').addEventListener('submit', function(e) {
e.preventDefault();
if (!selectedFiles || selectedFiles.length === 0) {
alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ñ–æ—Ç–æ!');
return;
}
const formData = new FormData(e.target);
const submitBtn = document.getElementById('submit-btn');
const progressContainer = document.getElementById('upload-progress-container');
const progressBar = document.getElementById('progress-bar-inner');
const progressPercentage = document.getElementById('progress-percentage');
const uploadStatus = document.getElementById('upload-status');
progressContainer.style.display = 'block';
submitBtn.disabled = true;
submitBtn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke-dasharray="15" stroke-dashoffset="60"><animate attributeName="stroke-dashoffset" dur="1.5s" repeatCount="indefinite" values="60;30;60"></animate></circle></svg> –û—Ç–ø—Ä–∞–≤–∫–∞...';
const xhr = new XMLHttpRequest();
xhr.timeout = 3000000;
xhr.upload.addEventListener('progress', function(event) {
if (event.lengthComputable) {
const percent = Math.round((event.loaded / event.total) * 100);
progressBar.style.width = `${percent}%`;
progressBar.textContent = `${percent}%`;
progressPercentage.textContent = `${percent}%`;
uploadStatus.innerHTML = `
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<circle cx="12" cy="12" r="10"></circle>
</svg>
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è: ${percent}% (${formatFileSize(event.loaded)} –∏–∑ ${formatFileSize(event.total)})
`;
uploadStatus.className = 'upload-status uploading';
}
});
xhr.addEventListener('load', function() {
if (xhr.status === 200) {
try {
const result = JSON.parse(xhr.responseText);
if (result.success) {
uploadStatus.innerHTML = `
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M20 6L9 17l-5-5"></path>
</svg>
‚úÖ –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ...
`;
uploadStatus.className = 'upload-status processing';
setTimeout(() => {
uploadStatus.innerHTML = `
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
<path d="M20 6L9 17l-5-5"></path>
</svg>
‚úÖ –ì–æ—Ç–æ–≤–æ! ${result.uploaded_count} —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–∞ ${result.processing_time} —Å–µ–∫
`;
uploadStatus.className = 'upload-status success';
alert(`‚úÖ ${result.message}
ID: ${result.id}`);
e.target.reset();
selectedFiles = [];
progressContainer.style.display = 'none';
submitBtn.disabled = true;
submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ';
loadDashboard();
showTab('properties');
}, 1000);
} else {
throw new Error(result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
}
} catch (error) {
uploadStatus.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke="red"></circle></svg> ‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
uploadStatus.className = 'upload-status error';
submitBtn.disabled = false;
submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ';
}
} else {
uploadStatus.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke="red"></circle></svg> ‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (${xhr.status})`;
uploadStatus.className = 'upload-status error';
submitBtn.disabled = false;
submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ';
}
});
xhr.addEventListener('error', function() {
uploadStatus.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke="red"></circle></svg> ‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.';
uploadStatus.className = 'upload-status error';
submitBtn.disabled = false;
submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ';
});
xhr.addEventListener('timeout', function() {
uploadStatus.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke="red"></circle></svg> ‚è±Ô∏è –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (5 –º–∏–Ω—É—Ç). –°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.';
uploadStatus.className = 'upload-status error';
submitBtn.disabled = false;
submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ';
});
xhr.open('POST', `${API_BASE}/properties`, true);
xhr.send(formData);
});

function formatFileSize(bytes) {
if (bytes === 0) return '0 –ë';
const k = 1024;
const sizes = ['–ë', '–ö–ë', '–ú–ë', '–ì–ë'];
const i = Math.floor(Math.log(bytes) / Math.log(k));
return (bytes / Math.pow(k, i)).toFixed(1) + ' ' + sizes[i];
}

document.getElementById('banner-form').addEventListener('submit', async (e) => {
e.preventDefault();
const formData = new FormData(e.target);
const page = document.getElementById('banner-page').value;
if (page === 'thailand') {
const targetPropertyId = document.getElementById('target-property-select').value;
if (!targetPropertyId) {
alert('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–ª—è –±–∞–Ω–Ω–µ—Ä–∞ –¢–∞–∏–ª–∞–Ω–¥–∞!');
return;
}
}
try {
const response = await fetch(`${API_BASE}/banners`, { method: 'POST', body: formData });
const result = await response.json();
if (result.success) {
alert('‚úÖ –ë–∞–Ω–Ω–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω! ID: ' + result.id);
e.target.reset();
document.getElementById('target-property-group').style.display = 'none';
document.getElementById('banner-order-group').style.display = 'block';
document.getElementById('banner-link-group').style.display = 'block';
loadBanners();
loadDashboard();
} else {
alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–Ω–µ—Ä–∞:', error);
alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏');
}
});

function editProperty(id) {
alert('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è #' + id + '\n–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.');
}

function editBanner(id) {
alert('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞ #' + id + '\n–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.');
}

window.addEventListener('DOMContentLoaded', () => {
loadDashboard();
loadThailandPropertiesForSelect();
});
</script>
</body>
</html>